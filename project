#include<iostream>
#include<fstream>
#include<string>
#include<vector>

using namespace std;

#define name_file  "data_siup_loin/"
#define name_file_cart  "data_cart/"

const int cpusize = 10;
const int Gpusize = 12;
const int ramsize = 11;
const int psusize = 10;
const int casesize = 9;
const int mobosize = 10;
const int storunsize = 11;

string usr;

void cart();
void total_money();
void menu();
void log_in();
void sign_up();
void cpu();
void Gpu();
void ram();
void psu();
void cases();
void mobo();
void storun();

int main()
{
    
    //login_and_singup------------------------------------
    int n;
    cout << "\n                             ----------------------------welcome--------------------------------                   \n";
    //  cout << "                                                      Choose one option: ";
    cout << "\n                                                     press 1 to SignUp";
    cout << "\n                                                     press 2 to LogIn\n";
    cin >> n;
    if (n == 1)
        sign_up();
    else if (n == 2)
        log_in();
    else
    {
        cout << "                                               You didn't choose 1 or 2....\n";
        cout << "                                                       Try again...\n";
        main();
    }
    system("cls");
    //-----------------------------------------------------
   
    //menu-------------------------------------------------
    menu();


    return 0;
}

void menu()
{
    char num;
    cout << "\n                             ---------------------------main menu-------------------------------                   \n\n";
    cout << "                                                        main menu: \n";
    cout << "                                                        [0]cart\n";
    cout << "                                                        [1]Processor\n";
    cout << "                                                        [2]Graphics cards\n";
    cout << "                                                        [3]Memory\n";
    cout << "                                                        [4]Power supplies\n";
    cout << "                                                        [5]Cases\n";
    cout << "                                                        [6]Motherboards\n";
    cout << "                                                        [7]Storage units\n";
    cout << "                                                        Press any key to exit.\n\n";
    cout << "                                                        Choose from the menu: ";
    cin >> num;

    switch (num)
    {
    case '0': cart(); menu();
    case '1': cpu();
    case '2': Gpu();
    case '3': ram();
    case '4':
    case '5':
    case '6':
    case '7':
    default: break;
    }
}

void cart()
{
    cout << "\n                             ------------------------------cart---------------------------------                   \n\n";
    ifstream cartread;
    string urname = name_file_cart + usr + ".txt";
    cartread.open(urname, ios::in);
    if (cartread.is_open()) {

        string read_line;
        while (getline(cartread, read_line))
        {
            cout << "                             " << read_line;
            cout << endl;
        }
        total_money();
        cartread.close();
    }
}

void total_money()
{
    ifstream viewcartm;
    string viewcarttotal = name_file_cart + usr + "pr" + ".txt";
    viewcartm.open(viewcarttotal);

    //Code to know the number of lines in the file--------
    int count = 0;
    string line;
    ifstream file(viewcarttotal);
    while (getline(file, line))
        count++;
    //-----------------------------------------------------
    vector<int> monet(count);
    if (viewcartm.is_open()) {
        for (int i = 0; i < count; i++) {
            viewcartm >> monet[i];
        }
        int sum = 0;
        int total;
        for (int j = 0; j < count; j++) {
            cout << "                             " << monet[j] << "EGP" << endl;
            total = monet[j];
            sum += total;
        }
        cout <<"                             Total items = " << count;
        cout <<"                             Total money = " << sum <<"EGP";
    }
}

void log_in()
{
    cout << "\n                             ---------------------------login--------------------------------                  \n\n";
    string nam, ps, userr, pss;
    cout << "                                                Enter your username: ";
    cin >> userr;
    cout << "                                                Enter your password: ";
    cin >> pss;

    ifstream logfile;
    string urname = name_file + userr + ".txt";
    logfile.open(urname);
    if (logfile.is_open())
    {
        logfile >> usr;
        logfile >> nam;
        logfile >> ps;
        if (userr == usr && pss == ps) {
            cout << "\n                                              You are successfully logged in:)\n";
            //  cout << "User-name:" << usr << endl;
            //  cout << "mail:" << nam << endl;
            logfile.close();
        }
        else {
            cout << "\n                                              Wrong username or password!\n";
            cout << "                                                 Please try Again.\n";
            log_in();
        }
        cout << endl;
    }
    else
    {
        cout << "\n                                                 Username not found.\n";
        cout << "                                                   please sign up.\n";
        sign_up();
    }
}

void sign_up()
{
    cout << "\n                             ---------------------------signup-------------------------------                   \n\n";
    string mail, username, password;
    cout << "                                                 Enter your username: ";
    cin >> username;
    cout << "                                                 Enter your mail: ";
    cin >> mail;
    cout << "                                                 Enter your password: ";
    cin >> password;

    ofstream ofile;
    string dir = name_file + username + ".txt";
    ofile.open(dir);
    ofile << username << endl << mail << endl << password;
    ofile.close();
    cout << "\n                                             You are successfully registered:)\n";
    log_in();
}

void cpu()
{
    // get data from file-------------------------------
    ifstream cpufiledata;
    ifstream cpufileprice;
    cpufiledata.open("cpudata.txt");
    cpufileprice.open("cpuprice.txt");
    string cpu_name[cpusize];
    int cpu_pr[cpusize];

    for (int n1 = 0; n1 < cpusize; n1++) {
        getline(cpufiledata, cpu_name[n1]);
        cpufileprice >> cpu_pr[n1];
    }
    //---------------------------------------------------
    
    //out put to user------------------------------------

    cout << "\n                             ---------------------------Processor----------------------------------                \n\n";

    for (int n = 0; n < cpusize; n++)
    {
        cout << "                              [" << n + 1 << "]" << cpu_name[n] << "   {" << cpu_pr[n] << " EGP}" << endl;
    }
    cout << "                              Press any key to back to main menu.\n";
    //----------------------------------------------------
     
    //save chooses price in file--------------------------
    ofstream cartfileprice;
    string dircartpr = name_file_cart + usr + "pr" + ".txt";
    cartfileprice.open(dircartpr, ios::out | ios::app);
    //----------------------------------------------------
    
    //save chooses in file--------------------------------
    ofstream cartfile;
    string dircart = name_file_cart + usr + ".txt";
    cartfile.open(dircart, ios::out | ios::app);
    char ch;
    cout << "                              choos number: ";
    cin >> ch;
    switch (ch)
    {
    case '1': cartfile << cpu_name[0]; cartfile << endl; cartfileprice << cpu_pr[0]; cartfileprice << endl; cpu();
    case '2': cartfile << cpu_name[1]; cartfile << endl; cartfileprice << cpu_pr[1]; cartfileprice << endl; cpu();
    case '3': cartfile << cpu_name[2]; cartfile << endl; cartfileprice << cpu_pr[2]; cartfileprice << endl; cpu();
    case '4': cartfile << cpu_name[3]; cartfile << endl; cartfileprice << cpu_pr[3]; cartfileprice << endl; cpu();
    case '5': cartfile << cpu_name[4]; cartfile << endl; cartfileprice << cpu_pr[4]; cartfileprice << endl; cpu();
    case '6': cartfile << cpu_name[5]; cartfile << endl; cartfileprice << cpu_pr[5]; cartfileprice << endl; cpu();
    case '7': cartfile << cpu_name[6]; cartfile << endl; cartfileprice << cpu_pr[6]; cartfileprice << endl; cpu();
    case '8': cartfile << cpu_name[7]; cartfile << endl; cartfileprice << cpu_pr[7]; cartfileprice << endl; cpu();
    case '9': cartfile << cpu_name[8]; cartfile << endl; cartfileprice << cpu_pr[8]; cartfileprice << endl; cpu();
    case '10':cartfile << cpu_name[9]; cartfile << endl; cartfileprice << cpu_pr[9]; cartfileprice << endl; cpu();
    default: menu();
    }
    //----------------------------------------------------
    
    //close files-----------------------------------------
    cartfile.close();
    cpufiledata.close();
    cpufileprice.close();
    cartfileprice.close();
    //----------------------------------------------------
}

void Gpu()
{
    
}

void ram()
{
    
}

void psu()
{

}

void cases()
{

}

void mobo()
{

}

void storun()
{

}
